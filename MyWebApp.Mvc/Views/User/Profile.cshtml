@using Microsoft.AspNetCore.Identity
@using MyWebApp.Models
@inject UserManager<ApplicationUser> UserManager
@{
    ViewData["Title"] = "Hồ sơ cá nhân";
    var user = await UserManager.GetUserAsync(User);
}

<div class="profile-container">
    <section class="section">
        <div class="section-header">
            <h2 class="section-title">Hồ sơ cá nhân</h2>
        </div>

        <div class="auth-box" style="max-width: 600px; margin: 0 auto;">
            @if (ViewBag.Success != null)
            {
                <div class="alert alert-success" style="padding: 12px; background-color: rgba(29, 185, 84, 0.1); border: 1px solid var(--spotify-green); border-radius: 8px; margin-bottom: 20px; color: var(--spotify-green);">
                    @ViewBag.Success
                </div>
            }

            @if (ViewBag.Error != null)
            {
                <div class="alert alert-danger" style="padding: 12px; background-color: rgba(255, 0, 0, 0.1); border: 1px solid #ff0000; border-radius: 8px; margin-bottom: 20px; color: #ff0000;">
                    @ViewBag.Error
                </div>
            }

            <form asp-controller="User" asp-action="UpdateProfile" method="post">
                <div class="form-group">
                    <label>Tên đầy đủ</label>
                    <input type="text" name="fullName" value="@user?.FullName" required />
                </div>

                <div class="form-group">
                    <label>Email</label>
                    <input type="email" value="@user?.Email" readonly style="background-color: var(--spotify-darker); cursor: not-allowed;" />
                    <small style="color: var(--spotify-light-gray); font-size: 12px; display: block; margin-top: 5px;">Email không thể thay đổi</small>
                </div>

                <div class="form-group">
                    <label>Mật khẩu hiện tại</label>
                    <input type="password" name="currentPassword" placeholder="Nhập để thay đổi mật khẩu" />
                </div>

                <div class="form-group">
                    <label>Mật khẩu mới</label>
                    <input type="password" name="newPassword" placeholder="Bỏ trống nếu không đổi" />
                </div>

                <div class="form-group">
                    <label>Xác nhận mật khẩu mới</label>
                    <input type="password" name="confirmNewPassword" placeholder="Bỏ trống nếu không đổi" />
                </div>

                <button type="submit" class="primary-btn" style="width: 100%; padding: 14px;">
                    Cập nhật hồ sơ
                </button>
            </form>

            <div style="margin-top: 30px; padding-top: 30px; border-top: 1px solid var(--spotify-darker);">
                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                    <span style="color: var(--spotify-light-gray);">Trạng thái tài khoản:</span>
                    <span style="color: var(--spotify-green); font-weight: 600;">Đã xác thực</span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span style="color: var(--spotify-light-gray);">Vai trò:</span>
                    <span style="color: var(--spotify-white); font-weight: 600;">
                        @if (User.IsInRole("Admin"))
                        {
                            <text>Quản trị viên</text>
                        }
                        else
                        {
                            <text>Người dùng</text>
                        }
                    </span>
                </div>
            </div>
        </div>
    </section>
</div>
